# Sky Protocol Project Catalyst Milestone 2

Reference: https://milestones.projectcatalyst.io/projects/1200203/milestones/2

## Abstract

This repository demonstrates the interplay between a bridge contract
that stores the root hash of a data availability merkle tree, and a
client contract that uses the root hash stored in the bridge to pay
out a bounty.

The root hash in the bridge is stored in an NFT UTXO and must be
signed by a committee of data availability providers.

# Testing the contracts

Requirements: Debian/Ubuntu Linux box.

## Setup

Setting up requires two automated and two manual steps:

### Step 1: Install dependencies and generate keys (link:pre-setup.sh[])

```
./pre-setup.sh
```

### Step 2: Manual configuration

#### Step 2.1: Configure Blockfrost provider

This requires a free Blockfrost API key from https://blockfrost.io/

Replace `YOUR_BLOCKFROST_API_KEY` and call the following command:

```
echo YOUR_BLOCKFROST_API_KEY > var/blockfrost.api-key
```

#### Step 2.2: Get funds from testnet faucet

Find the admin address:

```
cat var/admin.addr
```

Go to https://docs.cardano.org/cardano-testnets/tools/faucet/

Send funds to the admin address.

### Step 3: Finalize setup (link:post-setup.sh[])

```
./post-setup.sh
```

## Test 1: Updating the Bridge

This test demonstrates updating the bridge UTXO NFT with two different
merkle root hashes, and verifying (by querying the blockchain) that
the updates have indeed happened.

Check out the link:test-1.sh[] file for a more detailed description.

```
./test-1.sh
```

This uses the files:

* link:update-bridge.mjs[] to update the bridge NFT
* link:verify-bridge.mjs[] to verify the bridge NFT's current value

## Test 2: Offering and claiming a bounty

This test demonstrates offering a bounty that will be paid out if a
claimant can demonstrate that a particular datum is stored in the
merkle tree by providing a merkle proof.

Check out the link:test-2.sh[] file for a more detailed description.

```
./test-2.sh
```

This uses the files:

* link:offer-bounty.mjs[] to lock some funds at the bounty contract
* link:verify-bounty-offered.mjs[] to verify that some funds are locked at the contract
* link:claim-bounty.mjs[] to claim the bounty (i.e. unlock the locked funds)
* link:verify-bounty-claimed.mjs[] to verify that the locked funds have be claimed
